# Бэкенд окружение
При запуске окружения разворачиваются следующие сервисы:
- [Laravel](https://laravel.com/) - фреймворк для разработки веб-приложений с использованием PHP
- [PostgreSQL](https://www.postgresql.org/) - объектно-реляционная система управления базами данных
- [Adminer](https://www.adminer.org/) - инструмент для управления базами данных
- [Nginx](https://www.nginx.com/) - HTTP-сервер и обратный прокси-сервер
- [Centrifugo](https://centrifugal.dev/) - Centrifugo — это масштабируемый сервер обмена сообщениями в реальном времени с открытым исходным кодом

## Настройка
В `.env.example` прописаны все переменные, которые необходимо заполнить для работы окружения.

Общие переменные:
* `APP_KEY` - ключ приложения
* `PROJECT_NAME` - префикс для контейнеров

Переменные для базы данных:
* `DB_DATABASE` - имя базы данных
* `DB_USERNAME` - имя пользователя базы данных
* `DB_PASSWORD` - пароль пользователя базы данных
* `WEB_PORT` - порт, на котором будет работать приложение

Переменные для Центрифуги:
* `CENTRIFUGO_TOKEN_HMAC_SECRET_KEY` - HMAC секретный ключ для Centrifugo
* `CENTRIFUGO_ADMIN_PASSWORD` - пароль для администратора веб интерфейса
* `CENTRIFUGO_API_KEY` - ключ приложения
* `CENTRIFUGO_ADMIN_SECRET` - ключ для админки
* `ALLOWED_ORIGINS` - разрешенные адреса (можно *)

Переменные только для локального окружения:
* `USER` - имя пользователя, который будет создан в контейнере с приложением

## Запуск
Для запуска окружения необходимо:
* Перейти в папку в зависимости от окружения (develop, production)
* Скопировать файл `.env.example` в `.env` и заполнить переменные
* Выполнить команду `docker-compose up -d`

После запуска окружения в зависимости от установленного порта (`localhost:<PROXY_PORT>`) приложения будут доступны:
* [http://localhost/api](http://localhost/api) - бэкенд
* [http://localhost/adminer](http://localhost/adminer) - Управление базой данных (только для локального окружения)
* [http://localhost/centrifugo](http://localhost/centrifugo) - Админ-панель центрифуги (только для локального окружения)
* [http://localhost/api/test](http://localhost/api/test) - Страница интеграции фронта с центрифугой
* [http://localhost/api/users](http://localhost/api/users) - Эндпойнт возвращает спискок пользователь
* [http://localhost/api/user/<id>](http://localhost/api/user/<id>) - Эндпойнт возвращает одного пользователя (+генерит события рассылки в центрифугу)